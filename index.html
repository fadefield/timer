<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>W/L Counter for OBS</title>
    <script src="https://cdn.jsdelivr.net/npm/tmi.js@latest"></script>
    <style>
        body { margin:0; padding:0; background:transparent; overflow:hidden; font-family:Arial Black, Arial, sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; }
        #counter { font-size:96px; font-weight:bold; color:white; background:black; padding:20px 40px; border-radius:15px; white-space:nowrap; text-shadow:3px 3px 10px black; box-shadow:0 0 30px rgba(255,255,255,0.4); letter-spacing:2px; }
    </style>
</head>
<body>
    <div id="counter">W/L - 0 - 0</div>

    <script>
        let wins = 0;
        let losses = 0;
        function updateDisplay() {
            document.getElementById('counter').innerText = `W/L - ${wins} - ${losses}`;
        }

        const client = new tmi.Client({
            options: { debug: true },
            connection: { reconnect: true, secure: true },
            channels: ['skrait0']  // Change to 'neokipz' later when sharing
        });

        client.connect().catch(err => console.error('Connection error:', err));

        client.on('connected', (addr, port) => {
            console.log(`Connected to ${addr}:${port} anonymously!`);
        });

        client.on('message', (channel, tags, message, self) => {
            if (self) return;
            message = message.trim().toLowerCase();

            console.log(`Msg from ${tags.username}: ${message} | Broadcaster: ${!!tags.badges?.broadcaster} | Mod: ${!!tags.badges?.moderator}`);

            const isBroadcaster = !!tags.badges?.broadcaster;
            const isMod = !!tags.badges?.moderator;

            if (!isBroadcaster && !isMod) return;

            if (message.startsWith('!w')) {
                const arg = message.slice(2).trim();
                if (arg === '') {
                    wins += 1;
                } else {
                    const num = parseInt(arg, 10);
                    if (!isNaN(num) && num >= 0) wins = num;
                }
                updateDisplay();
            } else if (message.startsWith('!l')) {
                const arg = message.slice(2).trim();
                if (arg === '') {
                    losses += 1;
                } else {
                    const num = parseInt(arg, 10);
                    if (!isNaN(num) && num >= 0) losses = num;
                }
                updateDisplay();
            }
        });

        updateDisplay();  // Initial 0-0
    </script>
</body>
</html>
